<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panel Administrativo | Tapia Meléndez</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <style>
        .sidebar { min-height: 100vh; background-color: #1e293b; border-right: 1px solid #334155; }
        .admin-content { background-color: #0f172a; min-height: 100vh; color: white; }
        .stat-card { background-color: #1e293b; border: 1px solid #334155; border-radius: 15px; padding: 20px; transition: transform 0.3s; }
        .stat-card:hover { transform: translateY(-5px); border-color: #f59e0b; }
        .nav-link { color: #cbd5e1; font-weight: 600; padding: 15px 20px; border-radius: 10px; margin-bottom: 5px; }
        .nav-link:hover, .nav-link.active { background-color: #f59e0b; color: #0f172a; }
        
        /* Splash overlay para admin */
        .splash-overlay { 
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
            background-color: #0f172a; z-index: 9999; 
            display: flex; justify-content: center; align-items: center; 
            flex-direction: column; text-align: center; 
            transition: opacity 0.5s ease;
        }
    </style>
</head>
<body>

    <!-- SPLASH: CERRANDO SESIÓN -->
    <div id="splash-logout" class="splash-overlay" style="display: none; opacity: 0;">
        <img src="{{ url_for('static', filename='images/logo.png') }}" class="logo-pulse mb-3" width="100">
        <h2 class="fw-bold text-white">Cerrando sesión...</h2>
        <div class="loader mt-3"></div>
    </div>

    <!-- SPLASH: VOLVIENDO A TIENDA -->
    <div id="splash-web" class="splash-overlay" style="display: none; opacity: 0;">
        <img src="{{ url_for('static', filename='images/logo.png') }}" class="logo-pulse mb-3" width="100">
        <h2 class="fw-bold text-white">Volviendo a la tienda...</h2>
        <div class="loader mt-3"></div>
    </div>

<div class="d-flex">
    <!-- SIDEBAR -->
    <div class="d-flex flex-column p-3 text-white sidebar" style="width: 280px;">
        <div class="d-flex align-items-center mb-3 mb-md-0 me-md-auto text-white text-decoration-none">
            <img src="{{ url_for('static', filename='images/logo.png') }}" width="40" class="me-2">
            <span class="fs-6 fw-bold">PANEL GESTIÓN</span>
        </div>
        <hr>
        <ul class="nav nav-pills flex-column mb-auto">
            <li class="nav-item"><a href="#" class="nav-link active"><i class="bi bi-speedometer2 me-2"></i> Dashboard</a></li>
            <li><a href="#" class="nav-link"><i class="bi bi-box-seam me-2"></i> Productos</a></li>
            <li><a href="#" class="nav-link"><i class="bi bi-people me-2"></i> Usuarios</a></li>
            <li><a href="#" class="nav-link"><i class="bi bi-cart-check me-2"></i> Ventas</a></li>
        </ul>
        <hr>
        
        <!-- USUARIO Y BOTONES -->
        <div class="dropdown">
            <a href="#" class="d-flex align-items-center text-white text-decoration-none dropdown-toggle" data-bs-toggle="dropdown">
                <div class="rounded-circle bg-warning text-dark d-flex justify-content-center align-items-center fw-bold" style="width: 32px; height: 32px;">
                    {{ user[0] | upper }}
                </div>
                <strong class="ms-2">{{ user }}</strong>
            </a>
            <ul class="dropdown-menu dropdown-menu-dark text-small shadow">
                <li><a class="dropdown-item" href="#" onclick="goWeb()">Ir a Tienda</a></li>
                <li><hr class="dropdown-divider"></li>
                <li><a class="dropdown-item text-danger" href="#" onclick="goLogout()">Cerrar Sesión</a></li>
            </ul>
        </div>
        
        <!-- Botones directos abajo (Opcional por si no usan el dropdown) -->
        <div class="mt-3 d-grid gap-2">
            <button onclick="goWeb()" class="btn btn-outline-light btn-sm"><i class="bi bi-shop"></i> Ver Web</button>
            <button onclick="goLogout()" class="btn btn-outline-danger btn-sm"><i class="bi bi-box-arrow-right"></i> Salir</button>
        </div>
    </div>

    <!-- CONTENIDO PRINCIPAL -->
    <div class="flex-grow-1 admin-content p-5">
        <h2 class="fw-bold mb-4">Bienvenido, <span class="text-accent">{{ user }}</span></h2>
        
        <!-- Tarjetas de Resumen (ESTÁTICAS POR AHORA) -->
        <div class="row g-4 mb-5">
            <div class="col-md-4">
                <div class="stat-card">
                    <h5 class="text-muted mb-2">Total Productos</h5>
                    <h2 class="fw-bold">--</h2>
                    <i class="bi bi-box-seam text-accent fs-1 float-end" style="margin-top: -40px;"></i>
                </div>
            </div>
            <div class="col-md-4">
                <div class="stat-card">
                    <h5 class="text-muted mb-2">Ventas del Mes</h5>
                    <h2 class="fw-bold">S/ --.--</h2>
                    <i class="bi bi-graph-up-arrow text-success fs-1 float-end" style="margin-top: -40px;"></i>
                </div>
            </div>
            <div class="col-md-4">
                <div class="stat-card">
                    <h5 class="text-muted mb-2">Usuarios Activos</h5>
                    <h2 class="fw-bold">1</h2>
                    <i class="bi bi-people-fill text-info fs-1 float-end" style="margin-top: -40px;"></i>
                </div>
            </div>
        </div>

        <div class="alert alert-warning border-0 bg-opacity-10 text-warning">
            <i class="bi bi-cone-striped me-2"></i> 
            <strong>Módulos en Construcción:</strong> Estamos migrando las funcionalidades de Inventario y Ventas (POS) a este panel.
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
    // Lógica Salir
    function goLogout() {
        const splash = document.getElementById('splash-logout');
        splash.style.display = 'flex';
        setTimeout(() => { splash.style.opacity = '1'; }, 10);
        
        // Espera 2 segundos y redirige a logout real
        setTimeout(() => {
            window.location.href = "/logout";
        }, 2000);
    }

    // Lógica Ir a Web
    function goWeb() {
        const splash = document.getElementById('splash-web');
        splash.style.display = 'flex';
        setTimeout(() => { splash.style.opacity = '1'; }, 10);
        
        setTimeout(() => {
            window.location.href = "/";
        }, 2000);
    }
</script>
</body>
</html>
